# 技術スタック (tech.md)

## 1. アーキテクチャ

本プロジェクトでは、モダンなiOS開発プラクティスに則り、以下のアーキテクチャを採用します。

- **アーキテクチャパターン**: **MVVM (Model-View-ViewModel)**
  - SwiftUIのデータバインディング能力を最大限に活用し、UIロジックとビジネスロジックを明確に分離します。
- **モジュール分割**:
  - **App Target**: UI層（View、ViewModel）を担当します。
  - **Local Swift Package (`ShimaenagaGameCore`)**: アプリケーションのコアとなるビジネスロジック、データモデル、ゲームルールを管理する独立したモジュールです。これにより、UIからロジックを完全に切り離し、テストの高速化と再利用性の向上を実現します。

## 2. 技術詳細

- **UIフレームワーク**: **SwiftUI**
  - 宣言的なシンタックスを用いて、動的でインタラクティブなUIを効率的に構築します。
- **言語**: **Swift (最新版)**
  - 安全で高速な最新のSwiftの機能を全面的に採用します。
- **状態管理**:
  - **@Observable マクロ**: iOS 17から導入された機能で、ViewModelとView間のリアクティブなデータフローを簡潔に実装します。
  - **@State**: View内の局所的なUI状態（アニメーションのトリガーなど）を管理します。
- **データ永続化**: **SwiftData**
  - Core Dataの後継となるモダンな永続化フレームワーク。`@Model`マクロを用いて、型安全かつ宣言的にデータモデルを定義し、ゲームの状態やペットのデータをデバイス内に安全に保存します。

## 3. 開発環境

- **IDE**: **Xcode (最新版)**
- **対象OS**: **iOS 17.0 以降**
  - `@Observable`マクロ、SwiftData、SwiftTestingといった最新のフレームワーク機能を活用するため、OSバージョンをiOS 17以上に設定します。
- **依存関係管理**: **Swift Package Manager (SPM)**
  - プロジェクト内の`ShimaenagaGameCore`をローカルパッケージとして管理します。

## 4. テスト戦略

- **ユニットテスト**:
  - `ShimaenagaGameCore`パッケージ内のビジネスロジックは、**SwiftTesting**フレームワークを用いてテストします。
  - `swift test`コマンドにより、シミュレータを起動せずに高速なテスト実行が可能です。
- **UIテスト / 統合テスト**:
  - アプリケーションターゲット側で、ViewModelとViewの連携を**XCTest**または**SwiftTesting**を用いてテストします。

## 5. セキュリティとプライバシー

- **データ収集**: 個人を特定する情報は一切収集しません。
- **通信**: アプリケーションは完全にオフラインで動作し、外部との通信は行いません。
- **データ保存**: ユーザーが撮影した写真は、アプリ内のサンドボックス環境にのみ保存され、外部からアクセスすることはできません。
